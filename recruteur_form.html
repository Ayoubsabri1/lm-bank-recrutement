<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Espace Recruteur - LM BANK</title>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;700&display=swap" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    <style>
        body {
            background-color: #f0f2f5;
            font-family: 'Outfit', sans-serif;
        }

        /* Custom Header */
        .recruiter-header {
            background: linear-gradient(135deg, #004B87 0%, #002845 100%);
            padding: 20px 0;
            color: white;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-btn {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            padding: 8px 15px;
            border-radius: 6px;
            text-decoration: none;
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: 0.3s;
            font-size: 0.9rem;
        }

        .header-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .dashboard-btn {
            background: #F15A24;
            border-color: #F15A24;
            font-weight: 600;
        }

        .dashboard-btn:hover {
            background: #d1400e;
        }

        /* Form Card */
        .form-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
            padding: 40px;
            max-width: 800px;
            margin: 40px auto;
            border-top: 5px solid #00AEEF;
        }

        .form-title {
            color: #004B87;
            border-bottom: 1px solid #eee;
            padding-bottom: 20px;
            margin-bottom: 30px;
            font-size: 1.8rem;
        }

        /* Dimension Box */
        .dimension-box {
            background: #f8fbff;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #e1ecf7;
            margin-bottom: 20px;
            position: relative;
        }

        .dimension-box::before {
            content: "Critères de Matching (IA)";
            position: absolute;
            top: -10px;
            left: 15px;
            background: #00AEEF;
            color: white;
            padding: 2px 10px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        /* Login Overlay */
        #login-overlay {
            background: rgba(0, 75, 135, 0.95);
            backdrop-filter: blur(5px);
        }

        .login-card {
            background: white;
            padding: 50px 40px;
            border-radius: 12px;
            width: 100%;
            max-width: 400px;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
            text-align: center;
        }
    </style>
</head>

<body style="opacity: 0; transition: opacity 0.5s;">

    <!-- HEADER (Visible after login) -->
    <header class="recruiter-header">
        <div class="container header-content">
            <div style="display: flex; align-items: center; gap: 15px;">
                <i class="fas fa-university fa-2x"></i>
                <div>
                    <h2 style="margin:0; font-weight: 600;">Espace Recrutement</h2>
                    <span style="font-size: 0.85rem; opacity: 0.8;">LM BANK Portal</span>
                </div>
            </div>
            <div style="display: flex; gap: 10px;">
                <a href="admin_dashboard.html" class="header-btn dashboard-btn">
                    <i class="fas fa-chart-line"></i> Dashboard
                </a>
                <a href="index.html" class="header-btn">
                    <i class="fas fa-home"></i> Accueil
                </a>
                <button onclick="logout()" class="header-btn" style="cursor: pointer;">
                    <i class="fas fa-sign-out-alt"></i>
                </button>
            </div>
        </div>
    </header>

    <div class="container">
        <div class="form-card">
            <div
                style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; border-bottom: 1px solid #eee; padding-bottom: 20px;">
                <h2 style="margin:0; color: #004B87;">Publier une Offre</h2>
                <span
                    style="background: #e6fff0; color: #00a854; padding: 5px 12px; border-radius: 20px; font-size: 0.85rem; font-weight: 600;">
                    <i class="fas fa-circle" style="font-size: 8px; vertical-align: middle;"></i> Système Actif
                </span>
            </div>

            <form id="offer-form">
                <div class="form-group">
                    <label style="font-weight: 600; color: #333;">Titre du poste <span
                            style="color:red">*</span></label>
                    <input type="text" id="titre" required placeholder="Ex: Chef de Projet IT"
                        style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 6px; margin-bottom: 15px;">
                </div>

                <div class="form-row"
                    style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                    <div>
                        <label style="font-weight: 600; color: #333;">Ville d'affectation</label>
                        <select id="ville" required
                            style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 6px;">
                            <option value="Casablanca">Casablanca</option>
                            <option value="Rabat">Rabat</option>
                            <option value="Marrakech">Marrakech</option>
                            <option value="Tanger">Tanger</option>
                            <option value="Fès">Fès</option>
                            <option value="Agadir">Agadir</option>
                            <option value="Autre">Autre</option>
                        </select>
                    </div>
                    <div>
                        <label style="font-weight: 600; color: #333;">Type de contrat</label>
                        <select id="contrat" required
                            style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 6px;">
                            <option value="CDI">CDI</option>
                            <option value="CDD">CDD</option>
                            <option value="Stage">Stage</option>
                            <option value="Freelance">Freelance</option>
                        </select>
                    </div>
                </div>

                <!-- CRITICAL DIMENSIONS BOX -->
                <div class="dimension-box">
                    <div class="form-row" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div>
                            <label style="font-weight: 600; color: #333;">Niveau Requis (Min)</label>
                            <select id="niveau_requis" required
                                style="width: 100%; padding: 12px; border: 1px solid #b3d7ff; border-radius: 6px;">
                                <option value="Bac">Bac</option>
                                <option value="Bac+2">Bac+2</option>
                                <option value="Bac+3">Bac+3</option>
                                <option value="Bac+5">Bac+5</option>
                                <option value="Doctorat">Doctorat</option>
                            </select>
                        </div>
                        <div>
                            <label style="font-weight: 600; color: #333;">Expérience (Années)</label>
                            <input type="number" id="experience_requise" required min="0" value="0"
                                style="width: 100%; padding: 12px; border: 1px solid #b3d7ff; border-radius: 6px;">
                        </div>
                    </div>
                </div>

                <div class="form-group" style="margin-bottom: 25px;">
                    <label style="font-weight: 600; color: #333;">Description du poste</label>
                    <textarea id="description" rows="5" required placeholder="Responsabilités, compétences requises..."
                        style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 6px;"></textarea>
                </div>

                <div style="text-align: right;">
                    <button type="submit"
                        style="background: #00AEEF; color: white; border: none; padding: 12px 30px; border-radius: 30px; font-weight: 600; cursor: pointer; display: inline-flex; align-items: center; gap: 10px; transition: 0.3s; font-size: 1rem;">
                        <i class="fas fa-paper-plane"></i> Publier l'offre
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Login Modal -->
    <div id="login-overlay"
        style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 9999; display: flex; align-items: center; justify-content: center;">
        <div class="login-card">
            <i class="fas fa-lock"
                style="font-size: 3rem; color: #00AEEF; margin-bottom: 20px; background: #e0f7ff; padding: 20px; border-radius: 50%;"></i>
            <h2 style="color: #004B87; margin-bottom: 10px;">Accès Sécurisé</h2>
            <p style="color: #777; margin-bottom: 30px;">Veuillez vous identifier pour accéder au système.</p>

            <form id="login-form">
                <div style="position: relative; margin-bottom: 20px;">
                    <i class="fas fa-key" style="position: absolute; left: 15px; top: 14px; color: #bbb;"></i>
                    <input type="password" id="admin-pass" placeholder="Mot de passe administrateur"
                        style="width: 100%; padding: 12px 12px 12px 40px; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem;">
                </div>
                <button type="submit"
                    style="width: 100%; padding: 14px; background: #004B87; color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; font-size: 1rem; transition: 0.3s;">
                    Se connecter
                </button>
            </form>
            <p id="login-error" style="color: #F15A24; font-size: 0.9rem; margin-top: 15px; display: none;">
                <i class="fas fa-exclamation-circle"></i> Mot de passe incorrect
            </p>
        </div>
    </div>

    <script>
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbx3WrOoWoaWnHqzZKqOZb4RI5eZGnEi09h_tB2wcISC7WC8AmlyLhj3dy08TyM1kWfd1w/exec';

        // Check Session on Load
        window.addEventListener('load', () => {
            document.body.style.opacity = '1';
            if (sessionStorage.getItem('recruiter_logged_in') === 'true') {
                document.getElementById('login-overlay').style.display = 'none';
            }
        });

        // Login Logic
        document.getElementById('login-form').addEventListener('submit', function (e) {
            e.preventDefault();
            const pass = document.getElementById('admin-pass').value;
            if (pass === 'admin123') {
                sessionStorage.setItem('recruiter_logged_in', 'true'); // SET SESSION
                document.getElementById('login-overlay').style.opacity = '0';
                setTimeout(() => {
                    document.getElementById('login-overlay').style.display = 'none';
                }, 300);
            } else {
                document.getElementById('login-error').style.display = 'block';
                document.getElementById('admin-pass').style.border = '1px solid #F15A24';
            }
        });

        // Logout Logic
        function logout() {
            sessionStorage.removeItem('recruiter_logged_in');
            location.reload();
        }

        document.getElementById('offer-form').addEventListener('submit', async function (e) {
            e.preventDefault();
            const btn = this.querySelector('button[type="submit"]');
            const originalHTML = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Publication...';
            btn.disabled = true;
            btn.style.opacity = '0.7';

            const formData = {
                action: 'add_offer',
                titre: document.getElementById('titre').value,
                ville: document.getElementById('ville').value,
                contrat: document.getElementById('contrat').value,
                niveau_requis: document.getElementById('niveau_requis').value,
                experience_requise: document.getElementById('experience_requise').value,
                description: document.getElementById('description').value
            };

            try {
                await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(formData)
                });

                // Show Success Alert (Custom)
                alert('✅ Offre publiée avec succès !\nLa comparaison avec les candidats a commencé.');
                this.reset();
            } catch (error) {
                alert('❌ Erreur technique. Veuillez réessayer.');
            } finally {
                btn.innerHTML = originalHTML;
                btn.disabled = false;
                btn.style.opacity = '1';
            }
        });
    </script>
</body>

</html>